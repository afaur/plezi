<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <title>AnoreXic by boazsegev</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>AnoreXic</h1>
        <h2>A small, pure Ruby, web app DSL/framework... so small - it&#39;s anorexic!</h2>

        <section id="downloads">
          <a href="https://github.com/boazsegev/anorexic/zipball/master" class="btn">Download as .zip</a>
          <a href="https://github.com/boazsegev/anorexic/tarball/master" class="btn">Download as .tar.gz</a>
          <a href="https://github.com/boazsegev/anorexic" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h1>
<a name="anorexic" class="anchor" href="#anorexic"><span class="octicon octicon-link"></span></a>Anorexic</h1>

<p><a href="http://badge.fury.io/rb/anorexic"><img src="https://badge.fury.io/rb/anorexic.svg" alt="Gem Version"></a>
<a href="http://inch-ci.org/github/boazsegev/anorexic"><img src="http://inch-ci.org/github/boazsegev/anorexic.svg?branch=master" alt="Inline docs"></a></p>

<p>A thin, lightweight, barebones, mutli-threaded Ruby alternative to Rails (ROR) and Sinatra frameworks... so thin, it's anorexic!</p>

<p>The philosophy is simple - pristine, simple and dedicated gems for each functionality allow for a custom made framework that is exactly the right size during runtime.</p>

<p>Anorexic is a barebones DLS that can run with or without Rack and offers single-port as well as multi-port service for basic and advanced web services alike.</p>

<p>...and since it's all pure Ruby, it's as easy as it gets.</p>

<h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>install it using:</p>

<pre><code>$ gem install anorexic
</code></pre>

<h2>
<a name="framework-usage" class="anchor" href="#framework-usage"><span class="octicon octicon-link"></span></a>Framework Usage</h2>

<p>to create a new barebones app using the Anorexic framework, run from terminal:</p>

<pre><code>$ anorexic new appname
</code></pre>

<p>That's it, now you have a ready to use basic web server (with some demo code), just run it:</p>

<pre><code>$ cd appname
$ ./appname.rb # ( or: anorexic s )
</code></pre>

<p>this is a smart framework app that comes very skinny and will happily eat any gem you feed it. it responds extra well to Thin and Haml, which you can enable in it's Gemfile.</p>

<p>now go, in your browser, to: http://localhost:3000/</p>

<p>the default first port for the app is 3000. you can set the first port to listen to by using the <code>-p</code> option (make sure you have permissions for the requested port):</p>

<pre><code>$ ./appname.rb -p 80
</code></pre>

<h2>
<a name="barebones-web-service" class="anchor" href="#barebones-web-service"><span class="octicon octicon-link"></span></a>Barebones Web Service</h2>

<p>Anorexic contains a simple single-use DSL (all the DLS methods are removed once the server starts running - less clutter while running).</p>

<p>you can run anorexic from your favorite Ruby terminal :) - Anorexic starts the moment you exit the terminal.</p>

<p>Anorexic creates a whole web service with three commands that speek for themselves:</p>

<ul>
<li>listen</li>
<li>route</li>
<li>shared_route</li>
</ul>

<p>this example is basic, useless, but required for every doc out there...</p>

<p>"Hello World!" in 3 lines - try it in irb (exit irb to start server):</p>

<pre><code>    require 'anorexic'
    listen
    route(/.?/) { |req, res| res.body &lt;&lt; "Hello World!" }
</code></pre>

<p>After you exited irb, the Anorexic server started up. go to http://localhost:3000/ and see it run :)</p>

<p>if more then one <code>listen</code> call was made, ports will be sequential (3000, 3001, 3002...) unless explicitly set(<code>listen 443</code>).</p>

<p><em>btw</em>: did you notice the catch-all regular-expression? you can write it like this too:</p>

<pre><code>    require 'anorexic'
    listen
    route('*') { |req, res| res.body &lt;&lt; "Hello World!" }
</code></pre>

<p>Here's a simple web server, complete with SSL (supported on Thin and webrick servers), in three (+1) lines of code, serving static pages from the <code>public</code> folder::</p>

<pre><code>    require 'anorexic'

    # set up a non-secure service on port 3000
    listen 3000, file_root: File.expand_path(File.join(Dir.pwd , 'public'))

    # set up a encrypted service on port 8080, works only with some servers (i.e. thin, webrick)
    listen 8080, ssl_self: true, file_root: File.expand_path(File.join(Dir.pwd , 'public')) 

    shared_route('/people') { |req, res| res.body &lt;&lt; "I made this :-)" }
</code></pre>

<h2>
<a name="anorexic-routes" class="anchor" href="#anorexic-routes"><span class="octicon octicon-link"></span></a>Anorexic Routes</h2>

<p>Routes have paths that tell the application which code to run for every request it recieves. when you set your browser to: <code>http://www.server.com/the/stuff/they/request?paramaters=params[:paramaters]</code> , this is the routes path: <code>/the/stuff/they/request</code></p>

<p>As long as Anorexic uses the Anorexic::RackServer class (we could change that, but why would we?), the routes will work the same for all the listening ports.</p>

<p>Anorexic allows your code to choose it's routes dynamically, in the order they are created. like so:</p>

<pre><code>require 'anorexic'
listen

# this route declines to answer
route('/') { |req, res| res.body &lt;&lt; "I Give Up!"; false }

# this route wins
route('/') { |req, res| res.body &lt;&lt; "I Win!" }

# this route never sees the light of day
route('/') { |request, response| response.body &lt;&lt; "Help Me!" }
</code></pre>

<p>Anorexic supports magic routes, in similar formats found in other systems, such as: <code>route "/:required/(:optional)/(:optional_with_format){[\\d]*}", Controler</code> -  <strong>please see the <code>route</code> documentation for more information on routes</strong>.</p>

<p>Anorexic assummes all simple string routes to be RESTful routes ( <code>"/user" == "/user/(:id)"</code> ).</p>

<p>Anorexic accepts Regexp routes as well as string and magic routes and defines a short cut for a catch-all route:</p>

<pre><code>require 'anorexic'
listen

# this route accepts paths that start with a number (i.e.: /nonumber)
route(/^\/[\d]+[\D]+/) { |req, res| res.body &lt;&lt; "Give me more numbers :)" }

# this route accepts paths that are just numbers (i.e.: /87652)
route(/^\/[\d]+$/) { |req, res| res.body &lt;&lt; "I Love Numbers!" }

# this route accepts paths that don't have any number (i.e.: /nonumber)
route(/^\/[\D]+$/) { |req, res| res.body &lt;&lt; "Where're my numbers :(" }

# this route catches everything else.
route('*') { |request, response| response.body &lt;&lt; "Gotcha!" }
</code></pre>

<h2>
<a name="anorexic-controller-classes" class="anchor" href="#anorexic-controller-classes"><span class="octicon octicon-link"></span></a>Anorexic Controller classes</h2>

<p>One of the best things about the Anorexic is it's ability to take in any class as a controller class and route to the classes methods with special support for RESTful methods (index, show, save, update, delete, before and after):</p>

<pre><code>    require 'pry'
    require 'anorexic'
    require 'thin' # will change the default server to thin automatically.

    class Controller
        def index
            "Hello World!"
        end
        def show
            "You're looking for: #{params[:id]}"
        end
        def debug
            binding.pry
            true
        end
        def delete
            "did you try /#{params["id"]}/?_method=delete"
        end
    end

    listen
    route "/users" , Controller
    route "/" , Controller
</code></pre>

<p>Controllers can even be nested (order matters) or have advanced uses that are definitly worth exploring.</p>

<p>Here's some food for thought - code similar to something actually used in the framework app:</p>

<pre><code>    require 'pry'
    require 'anorexic'
    require 'thin'

    class ReWriteController
        # using the before filter and regular expressions to make some changes.
        def before
            result = request.path.match /^\/(en|fr)($|\/.*)/
            if result
                params["locale"] = result[1].to_sym
                request.path_info = result[2]
            end
            return false
        end
    end

    class Controller
        def index
            return "Bonjour le monde!" if params[:locale] == :fr
            "Hello World!"
        end
        def show
            return "Vous êtes à la recherche d' : #{params[:id]}" if params[:locale] == :fr
            "You're looking for: #{params[:id]}"
        end
        def debug
            binding.pry
            true
        end
        def delete
            "Mon Dieu! Mon français est mauvais!" if params[:locale] == :fr
            "did you try /#{params["id"]}/?_method=delete"
        end
    end

    listen

    route "*" , ReWriteController

    route /^\/[\d\+\-\*\/\(\)\.]+$/ do |request, response|
        message = (request.params[:locale] == :fr) ? "La solution est" : "My Answer is"
        response.body &lt;&lt; "#{message}: #{eval(request.path[1..-1])}"
    end

    route "/users" , Controller

    route "/" , Controller
</code></pre>

<p>try:</p>

<ul>
<li>http://localhost:3000/</li>
<li>http://localhost:3000/users</li>
<li>http://localhost:3000/users/hello</li>
<li>http://localhost:3000/(5+5*20-15)/9</li>
</ul>

<h2>
<a name="anorexic-is-hungry-for-pristine-yummy-gems" class="anchor" href="#anorexic-is-hungry-for-pristine-yummy-gems"><span class="octicon octicon-link"></span></a>Anorexic is hungry for pristine yummy gems</h2>

<p>This is the "Pristine chunks" phylosophy.</p>

<p>Our needs are totally different for each project. An XML web service for an iPhone native app is a very different animal then a book-store web app (please, not another book store app...).</p>

<p>Together we can write add-ons and features and beautifuls gems that we will use when (and if) we need them - so our apps are always happy and never overweight!</p>

<h2>
<a name="what-about-ruby-on-rails-or-sinatra" class="anchor" href="#what-about-ruby-on-rails-or-sinatra"><span class="octicon octicon-link"></span></a>What about Ruby on Rails or Sinatra?</h2>

<p>I love the Ruby community and I know that we are realy good at writing gems and plug-ins that save a lot of time and code. But we don't need all the plug-ins all the time.</p>

<p>Ruby on Rails became too bloated and big for some projects... It's full of great features that some of them are sometimes used... but at the end of the day, it's HEAVY.</p>

<p>Looking into Sinatra benchmarks on the web showed that Rails and Sinatra frameworks perform on a similar level. The added 'lightness' just wasn't light enough.</p>

<p>Some of us started reverting to pure Rack, and a lot of code kept being written over and over again... Actually, Anorexic is just a smart wrapper to Rack, to make routing and MVC (Model-View-Controller) programming easier.</p>

<p>So sure, you can use Rails or Sinatra, they're great, but we Love to feed Anorexic our code, it just eats it up so nicely.</p>

<h1>
<a name="feed-the-anorexic-framework" class="anchor" href="#feed-the-anorexic-framework"><span class="octicon octicon-link"></span></a>Feed the Anorexic framework</h1>

<p>The whole of the Anorexic framework philosophy is about community, sharing and feeding the anorexic framework with small and pristine gems.</p>

<p>Please, feel free to contribute, push any changes on the github project and create your own gems to feed the Anorexic open framework.</p>

<h2>
<a name="contributing" class="anchor" href="#contributing"><span class="octicon octicon-link"></span></a>Contributing</h2>

<ol>
<li>Fork it ( <a href="https://github.com/boazsegev/anorexic/fork">https://github.com/boazsegev/anorexic/fork</a> )</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create a new Pull Request</li>
</ol>
      </section>
    </div>

    
  </body>
</html>